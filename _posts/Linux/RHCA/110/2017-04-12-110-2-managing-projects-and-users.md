---
layout: post
title:  "管理项目和用户(110-2)"
categories: Linux
tags: RHCA 110
---

### 管理项目

###### 什么是项目？

project是一组已被隔离的资源和对象，由与之关联的一组用户进行管理。较早版本的红帽 OpenStack 平台中曾经使用可与项目互换的“租户”一词。根据配置需求，project 可以映射到组织、帐户或客户。项目可以分配有一个或多个用户。分配到项目的用户有权在该项目内创建和管理虚拟资源。默认情况下，PackStack 安装中存在两个不同的项目：admin 和 services。admin 项目映射到 admin 用户帐户。services 项目映射到安装的各种不同 OpenStack 组件服务。项目可以由 admin 帐户创建，也可由分配了项目的 admin 成员资格角色的用户创建。创建项目时，项目信息存储在 MariaDB 数据库内。项目的访问权限级别由分配给用户的角色决定。依照所需的访问权限，一个用户可以在不同项目中拥有不同的角色。

###### 创建项目

项目可以通过 Horizon 控制面板或从 CLI 创建。本课程的这一部分将重点介绍使用 Horizon 控制面板创建项目。

1. 以 admin 用户身份使用 redhat 作为密码登录 Horizon 控制面板。
2. 在 Identity 选项卡内，单击创建项目按钮。输入 test1 作为 Name，输入 Initial Project Test 作为 Description，再将 Enabled 框保持为选中。
3. 要添加额外的用户，选择Project Members选项卡。单击 test-user1 和 test-user2 旁边的 plus 符号，然后单击创建项目。

删除项目

在 Horizon 控制面板中，删除项目的步骤与创建项目类似。不过，要注意删除项目的后果。如果用户除了所删除的项目之外还是其他项目的成员，此用户将不再能够通过当前项目下拉菜单访问该项目。如果用户不是其他项目的成员，此用户将不再能够登录 Horizon 控制面板。如果被删除的项目有正在运行的实例，该实例不会自动停止，而需要手动停止。

1. 以 admin 用户身份使用 redhat 作为密码登录 Horizon 控制面板。
2. 在 Identity 选项卡内，选择 dev-project 旁边的复选框，再选择删除项目。再次单击删除项目进行确认。


### 管理用户

###### 无特权用户

使用 OpenStack 部署中的用户来确定身份。在典型的 PackStack 部署过程中，会创建管理员用户和成员用户。无特权用户可以通过管理员帐户创建。也可以创建其他帐户，并分配到具体的项目。OpenStack 用户帐户提供身份信息，供 Keystone 在验证 API 调用时使用。在管理员创建用户帐户时，帐户信息将存储在 MariaDB 数据库中。



无特权用户可以执行下列操作：

*    启动实例。
*    创建卷和卷快照。
*    创建映像。
*    创建安全组和密钥对。
*    分配浮动 IP。
*    创建网络和路由器。
*    创建防火墙；添加规则和策略。
*    查看网络拓扑。
*    查看所分配的项目的限值和用量摘要。

###### 创建 管理用户

用户可以通过 Horizon 控制面板或从 CLI 创建。本课程的这一部分将重点介绍使用 Horizon 控制面板管理无特权用户。

1. 以 admin 用户身份使用 redhat 作为密码登录 Horizon 控制面板。
2. 要在身份选项卡中创建名为 level0-tech 的新用户，请选择用户选项卡。单击 +创建用户按钮以打开创建用户窗口。
3. 在创建用户窗口中，输入 level0-tech 作为用户名，level0-tech@lab.example.com 作为电子邮件，redhat 作为密码和确认密码，cloud-ops 作为主要项目，并在下拉菜单中将角色选择为 _member_ 。确保选中了已启用复选框。
4. 单击创建用户按钮以创建该用户。
5. 要将预先存在的用户分配到项目，请在身份选项卡内，选择项目选项卡。选择 cloud-ops 项目的管理成员。选择 level1-tech 旁边的加号，再单击保存。

###### 删除用户

只有 admin 帐户或具有管理员特权的帐户才能删除帐户。与禁用用户不同，帐户一旦被删除便无法撤销操作。删除的用户将从项目成员资格列表以及所分配的项目中移除。

1. 以 admin 用户身份使用 redhat 作为密码登录 Horizon 控制面板。
2. 导航到身份，再选择用户选项卡。单击 sleepy-tech 用户的Actions下拉菜单，再单击删除用户，然后再次单击删除用户进行确认。

###### 禁用用户帐户

admin 帐户或具有管理员特权的帐户可以禁用帐户。可以通过 Horizon 控制面板禁用用户，但一次只能操作一个用户。用户被禁用后，便无法再登录 Horizon 控制面板或访问 OpenStack 服务。已禁用用户的主要项目也不再能够被设为“活动”。任何被禁用的帐户都可重新启用。

1. 以 admin 用户身份使用 redhat 作为密码登录 Horizon 控制面板。
2. 导航到身份选项卡，再选择用户选项卡。在 Users 选项卡内，选择 tardy-tech 用户的Actions下拉菜单，再选择 Disable User。
3. 启用用户帐户： 导航到身份选项卡，再选择 Users 选项卡中。在用户选项卡内，选择 early-tech 用户的Actions下拉菜单，再单击 Enable User.

###### 更改密码

可以通过 Horizon 控制面板对管理员和无特权帐户用户帐户的密码进行管理。管理员和无特权帐户用户帐户的密码只能由具有管理员特权的帐户更改。在 PackStack 安装期间，可以通过 answers.txt 文件配置管理员的密码。如果不配置，PackStack 将自动生成一个。该密码位于 /root/keystonerc_admin 中。默认情况下，OpenStack 不提供密码复杂性检查。管理员可以创建密码只有一个字母的无特权用户帐户。但是，可以在 /etc/keystone.conf 中配置密码的最大长度。

1. 以 admin 用户身份使用 redhat 作为密码登录 Horizon 控制面板。
2. 导航到身份选项卡，再选择 Users 选项卡中。选择 early-tech 用户的Actions下拉菜单，再单击 Change Password。输入 tahder 作为新密码，然后单击保存。


### 管理用户角色和特权

###### 角色

OpenStack 实施基于角色的访问控制 (RBAC)，用于拒绝或允许对 API 资源的访问。在 PackStack 安装中，默认创建两个角色：管理员和 _member_。分配了 _member_ 角色的用户有权管理项目中的资源。分配了管理员角色的用户可以全面控制 OpenStack 环境。创建其他角色不是常见的做法，也无法通过 Horizon 控制面板实现。

###### admin 用户帐户

admin 用户帐户在 PackStack 安装中默认创建。admin 帐户或任何具有 admin 特权的帐户能够使用 Horizon 执行下列任务：

*    参数 	        描述
*    概述 	        查看基本报告
*    资源使用情况 	查看日常报告
*    Hypervisor 	查看系统管理程序摘要
*    主机聚合 	    查看、创建和编辑主机聚合
*    实例 	        对属于部分而非所有项目用户的运行中的实例，执行软重启或硬重启、查看、暂停、恢复、暂挂、迁移和删除等操作。
*    卷 	            创建、删除、查看和编辑卷
*    类别 	        创建、删除、查看和编辑类别
*    映像 	        创建、编辑、删除和查看映像
*    网络 	        创建、编辑、删除和查看网络
*    卷 	            创建、删除、查看和编辑卷
*    默认值 	        查看和编辑资源默认配额的上限
*    路由器 	        创建、编辑、删除和查看路由器
*    系统信息 	    查看和列出块存储服务、计算服务、网络代理和编配服务

###### 创建管理员用户

1. 以 admin 用户身份登录 Horizon 控制面板，再选择身份 > 用户。
2. 单击创建用户。
3. 输入以下各项的信息： username， email和 password。
4. 选择项目。
5. 选择 admin 角色。
6. 单击创建用户。

### 总结

在本章中，您可以学到：

*    项目是一组资源，映射到分配的一组用户。
*    项目只能通过具有管理特权的帐户创建和删除。
*    如果用户被禁用，那么该用户的主要项目就无法再设为“活动”。
*    分配了管理员角色的用户可以全面控制整个 OpenStack 环境。
*    分配了成员角色的用户有权管理项目中的资源。
